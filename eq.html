<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>three.js Graphic EQ</title>
    <style>
        body {
            /* set margin to 0 and overflow to hidden, to go fullscreen */
            margin: 0;
            overflow: hidden;
        }
    </style>
</head>

<body>
    <script src="docs/libraries/three.js"></script>
    <script src="docs/libraries/OrbitControls.js"></script>
    <script src="docs/libraries/stats.js"></script>

    <div id="container"></div>
    </div>


<script type="text/javascript">
/*** base Graphic EQ code by srchea  */

var camera, scene, renderer;
var controls;
var listener;

scene = new THREE.Scene();

function vertY(){
    // create an Audio source
    var sound = new THREE.Audio( listener );

    // load a sound and set it as the Audio object's buffer
    var audioLoader = new THREE.AudioLoader();
    audioLoader.load( "docs/00 - Cut Your Hair.mp3", function( buffer ) {
        sound.setBuffer( buffer );
        sound.setLoop(true);
        sound.setVolume(2);
        sound.play();
    });

    // create an AudioAnalyser, passing in the sound and desired fftSize
    var analyser = new THREE.AudioAnalyser( sound, 32 );

    // get the average frequency of the sound
    var data = analyser.getAverageFrequency();

    return data;
}


function setRect(n){    
        var geometry = new THREE.CubeGeometry(1, vertY, 1);
        var material = new THREE.MeshBasicMaterial({
            color: 0x7777f});
        var rect = new THREE.Mesh(geometry, material);
        rect.name = "rect-" + scene.children.length;

        //rect.position.z = -( 0 + (n*2) );    
        rect.translateZ(n * 2.5);

        scene.add(rect);
        
        console.log(n);
        console.log(scene.children);

}


function init() {

    camera = new THREE.PerspectiveCamera( 50, window.innerWidth / window.innerHeight, 1, 100 );
    camera.position.set( 50, 50, 50 );
    
    // create an AudioListener and add it to the camera
    listener = new THREE.AudioListener();
    camera.add( listener );

vertY();

    renderer = new THREE.WebGLRenderer();
    renderer.setSize( window.innerWidth, window.innerHeight );

    // show cubes in an array
    var i;
    for(i=0; i<10; i++) {
        setRect(i);
    }

    // show axes in the screen
    var axes = new THREE.AxesHelper(2);
    scene.add(axes);

    var ambientLight = new THREE.AmbientLight(0x7777ff);
    scene.add(ambientLight);

    controls = new THREE.OrbitControls(camera);
    controls.rotateSpeed = 4;
};

init();
controls.update();
renderer.render(scene, camera);
animate();

function animate() {
    requestAnimationFrame( animate );
    controls.update();
    renderer.render( scene, camera );
}

document.getElementById("container").appendChild(renderer.domElement);

</script>
</body>
</html>